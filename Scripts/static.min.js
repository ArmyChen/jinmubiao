var handlePlaceholderForIE = function() {
    if ($.browser.msie && $.browser.version.substr(0, 1) <= 9) {
        $("input[placeholder]").each(function() {
            var input = $(this);
            $(input).css("color", "#cacaca");
            $(input).val(input.attr("placeholder"));
            $(input).focus(function() {
                if (input.val() == input.attr("placeholder")) {
                    input.val("");
                    input.css("color", "#cacaca")
                } else {
                    if (input.val() != input.attr("placeholder")) {
                        input.css("color", "#333")
                    }
                }
            });
            $(input).keydown(function() {
                if (input.val() == input.attr("placeholder")) {
                    input.val("");
                    input.css("color", "#cacaca")
                } else {
                    if (input.val() != input.attr("placeholder")) {
                        input.css("color", "#333")
                    } else {
                        if (input.val() == "" || input.val() == input.attr("placeholder")) {
                            input.val(input.attr("placeholder"));
                            input.css("color", "#cacaca")
                        }
                    }
                }
            });
            $(input).blur(function() {
                if (input.val() == "" || input.val() == input.attr("placeholder")) {
                    input.val(input.attr("placeholder"));
                    input.css("color", "#cacaca")
                } else {
                    input.css("color", "#333")
                }
            })
        })
    }
}
;
$(function() {
    handlePlaceholderForIE();
    var indexTopFixed = function() {
        if ($(window).scrollTop() >= $(".bannerwrap").height()) {
            $("#indexTop").addClass("scroll")
        } else {
            $("#indexTop").removeClass("scroll")
        }
    }
    ;
    $(".topreg").click(function() {
        var regInfo = $.trim($(this).parent().parent().children().find("input").val());
        if (regInfo.match(/[\u4e00-\u9fa5]/)) {
            regInfo = ""
        }
        var reEmail = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        var reTel = /^1[0-9]{10}$/;
        if (regInfo.match(reEmail) || regInfo.match(reTel) || true) {
            $(this).next().fadeOut();
            window.open("http://web.jingoal.com/module/register/index.open?flag=" + regInfo, "_blank")
        } else {
            $(this).next().fadeIn();
            $(this).next().html("请输入手机或邮箱")
        }
    });
    var bannerAuto = function() {
        var width = $(window).width()
          , height = $(window).height()
          , opacity = 1;
        var scaleBanner = 1920 / 900;
        var scaleWindow = width / height;
        if (scaleBanner > scaleWindow) {
            $(".first-bg").css({
                height: "100%",
                width: height * scaleBanner,
                left: (height * scaleBanner - width) / -2,
                top: 0,
                opacity: opacity
            })
        } else {
            $(".first-bg").css({
                height: width / scaleBanner,
                width: "100%",
                left: 0,
                top: (width / scaleBanner - height) * -0.5,
                opacity: opacity
            })
        }
    }
    ;
    var toggleList = $(".togglelist a");
    var bannerList = $(".bannerlist .bannersrc");
    var sSize = bannerList.size();
    var curIndex = 0;
    toggleList.click(function() {
        curIndex = $(this).index();
        bannerChange(curIndex)
    });
    var bannerChange = function(curIndex) {
        toggleList.removeClass("cur");
        toggleList.eq(curIndex).addClass("cur");
        bannerList.stop();
        bannerList.eq(curIndex).siblings().animate({
            opacity: 0,
            zIndex: 1
        }, 1000);
        bannerList.eq(curIndex).animate({
            opacity: 1,
            zIndex: 2
        }, 1000)
    }
    ;
    var bannerAutoShow = function() {
        curIndex = curIndex + 1;
        if (curIndex <= sSize - 1) {
            bannerChange(curIndex)
        } else {
            curIndex = 0;
            bannerChange(curIndex)
        }
    }
    ;
    var timer = setInterval(bannerAutoShow, 6000);
    var clearInt = function() {
        toggleList.mouseover(function() {
            clearInterval(timer)
        })
    }
    ;
    var setInt = function() {
        toggleList.mouseout(function() {
            timer = setInterval(bannerAutoShow, 6000)
        })
    }
    ;
    clearInt();
    setInt();
    $("#regHeadInfo").focus(function() {
        clearInterval(timer)
    });
    $("#regHeadInfo").blur(function() {
        timer = setInterval(bannerAutoShow, 6000)
    });
    $(".scroll-arrow").click(function() {
        $("html,body").animate({
            scrollTop: $("#screenHover").height()
        }, 500)
    });
    $(".fix-backtop").click(function() {
        $("html,body").animate({
            scrollTop: "0px"
        }, 500)
    });
    $("#screenHover").height($(window).height());
    bannerAuto();
    $(".fix-QRcode").hover(function() {
        $(".downQRcode").stop().animate({
            "right": "49px"
        }, 400).show()
    });
    $(".fix-QRcode").mouseleave(function() {
        $(".downQRcode").stop().hide().animate({
            "right": "69px"
        }, 0)
    });
    var appToggleClose = "查看更多应用<span class='toggle-arrow'></span>"
      , appToggleOpen = "收起应用<span class='toggle-arrow up'></span>"
      , appToggle = false;
    $(".app-list li:gt(9)").hide();
    $(".app-toggle").click(function(e) {
        e.stopPropagation();
        if (appToggle) {
            $(".app-list li:gt(9)").slideUp(400);
            $(this).empty().append(appToggleClose);
            appToggle = false
        } else {
            $(".app-list li:gt(9)").slideDown(400);
            $(".app-list").css({
                "margin-bottom": "40px"
            });
            $(".app-bottom").hide();
            $(this).empty().append(appToggleOpen);
            appToggle = true
        }
    });
    indexTopFixed();
    var indexVideoPlay = function() {
        var winWidth = $(window).width()
          , winHeight = $(window).height() - 80;
        var scaleVideo = 524 / 860;
        if (winWidth <= winHeight) {
            $("#indexVideo").css({
                width: winWidth,
                marginLeft: -winWidth / 2,
                height: winWidth * scaleVideo,
                marginTop: -(winWidth * scaleVideo) / 2
            })
        } else {
            if (winWidth > winHeight) {
                $("#indexVideo").css({
                    width: winHeight / scaleVideo,
                    marginLeft: -(winHeight / scaleVideo) / 2,
                    height: winHeight,
                    marginTop: -winHeight / 2
                })
            }
        }
    }
    ;
    indexVideoPlay();
    $(".index-bg").click(function() {
        videoClose()
    });
    $(".mobi-menu").click(function(e) {
        e.stopPropagation();
        if (!$("ul.nav").is(":visible")) {
            $("ul.nav").slideDown(100);
            $("ul.nav").css({
                "box-shadow": "0 2px 2px rgba(0, 0, 0, 0.1)"
            })
        } else {
            if ($("ul.nav").is(":visible")) {
                $("ul.nav").slideUp(100);
                $("ul.nav").css({
                    "box-shadow": "none"
                })
            }
        }
    });
    if (!$(".subnav").hasClass("static")) {
        $("ul.nav li:eq(1)").hover(function() {
            $(".subnav").removeClass("hide")
        });
        $("ul.nav li:eq(1)").mouseleave(function() {
            $(".subnav").addClass("hide")
        })
    } else {
        $("ul.nav li:eq(1)").hover(function() {
            $(".subnav").removeClass("hide")
        });
        $("ul.nav li:eq(1)").mouseleave(function() {
            $(".subnav").removeClass("hide")
        })
    }
    if ($(window).scrollTop() >= 300) {
        $(".right-fixed").fadeIn(300)
    } else {
        $(".right-fixed").fadeOut(300)
    }
    $(".font-normal").click(function() {
        $(this).addClass("active").siblings().removeClass("active");
        $(".news-wrap").css({
            "font-size": "14px"
        })
    });
    $(".font-large").click(function() {
        $(this).addClass("active").siblings().removeClass("active");
        $(".news-wrap").css({
            "font-size": "16px"
        })
    });
    if ($(window).width() >= 769) {
        $("ul.nav").show();
        $("ul.nav").css({
            "box-shadow": "none"
        });
        $(".subnav").removeClass("static");
        $(".subnav").addClass("hide")
    } else {
        $("ul.nav").hide();
        $(".subnav").addClass("static");
        $(".subnav").removeClass("hide")
    }
    $(".video-oper ul li a").each(function() {
        $(this).click(function() {
            $(".video-oper ul li a").removeClass("cur");
            $(this).addClass("cur")
        })
    });
    $(".video-oper .video-title > a").each(function() {
        $(this).click(function() {
            if ($(this).parent().hasClass("open")) {
                $(this).parent().removeClass("open");
                $(this).next().slideUp()
            } else {
                $(this).parent().addClass("open");
                $(this).next().slideDown();
                $(this).parent().siblings().removeClass("open");
                $(this).parent().siblings().children("ul").slideUp()
            }
        })
    });
    $(".jobtype-list li a").click(function() {
        $(this).addClass("selected").siblings().removeClass("selected")
    });
    $(".jobs-tab table tbody > tr").each(function() {
        $(this).click(function() {
            $(".pop-wrap").show();
            $(".pop-bg").show()
        })
    });
    $(".pop-close").click(function() {
        $(".pop-wrap").hide();
        $(".pop-bg").hide()
    });
    $(".indexad-close").click(function() {
        $(".indexad-fixed").hide()
    });
    $(".indexad-topclose").click(function() {
        $(".indexad").hide()
    });
    // $("#firstSlide div[data-scro='controler'] b,#firstSlide div[data-scro='controler2'] a").click(function() {
    //     var T = $(this);
    //     if (T.attr("class") == "down") {
    //         return false
    //     }
    //     J2ROLLING_ANIMATION.st({
    //         findObject: T,
    //         main: T.parent().parent().find("div[data-scro='list']"),
    //         main2: T.parent().parent().find("div[data-scro='list2']"),
    //         pagSource: T.parent().parent().find("div[data-scro='controler'] b"),
    //         className: "down",
    //         duration: "fast",
    //         on: $(this)[0].tagName == "A" ? true : false
    //     });
    //     return false
    // });
    var J2SETTIME = ""
      , J2Time = true
      , J2ROLLING_ANIMATION = {
        init: function() {
            this.start();
            this.time()
        },
        st: function(o) {
            if (J2Time) {
                this.animate(o.findObject, o.main, o.main2, o.className, o.duration, o.pagSource, o.on);
                J2Time = false
            }
        },
        animate: function(T, M, M2, C, S, P, O) {
            var _prevDown = O ? P.parent().find("*[class='" + C + "']") : T.parent().find(T[0].tagName + "[class='" + C + "']")
              , _prevIndex = _prevDown.index()
              , _thisIndex = O ? (T.attr("class") == "next" ? _prevIndex + 1 : _prevIndex - 1) : T.index()
              , _list = M.find(".item")
              , _list2 = M2.find(".item")
              , p2n = 1;
            _prevDown.removeClass(C);
            if (O) {
                if (_thisIndex == -1) {
                    _thisIndex = _list.size() - 1
                }
                if (_thisIndex == _list.size()) {
                    _thisIndex = 0
                }
                P.eq(_thisIndex).addClass(C)
            } else {
                T.addClass(C)
            }
            if (T.attr("class") == "prev" || _thisIndex < _prevIndex) {
                p2n = false
            }
            if ((T.attr("class") == "next" || _thisIndex > _prevIndex) && T.attr("class") != "prev") {
                p2n = true
            }
            !p2n ? _list.eq(_thisIndex).css("left", -M.width()) : "";
            !p2n ? _list2.eq(_thisIndex).css("left", -M.width()) : "";
            _list.eq(_prevIndex).animate({
                left: p2n ? -M.width() : M.width()
            }, S, function() {
                $(this).removeAttr("style");
                J2Time = true
            });
            _list2.eq(_prevIndex).animate({
                left: p2n ? -M.width() : M.width()
            }, S, function() {
                $(this).removeAttr("style");
                J2Time = true
            });
            _list.eq(_thisIndex).animate({
                left: "0px"
            }, S);
            _list2.eq(_thisIndex).animate({
                left: "0px"
            }, S)
        },
        start: function() {
            $("#firstSlide div[data-scro='controler'] b,#firstSlide div[data-scro='controler2'] a").mouseover(function() {
                window.clearInterval(J2SETTIME)
            }).mouseout(function() {
                J2ROLLING_ANIMATION.time()
            })
        },
        time: function() {
            J2SETTIME = window.setInterval(function() {
                var num = $("#firstSlide div[data-scro='controler'] b[class='down']").index()
                  , _list = $("#firstSlide div[data-scro='list'] li")
                  , _list2 = $("#firstSlide div[data-scro='list2'] li");
                _list.eq(num).animate({
                    "left": -$("#firstSlide div[data-scro='list']").width()
                }, "slow", function() {
                    $(this).removeAttr("style");
                    $("#firstSlide div[data-scro='controler'] b").removeClass("down").eq(num).addClass("down")
                });
                _list2.eq(num).animate({
                    "left": -$("#firstSlide div[data-scro='list2']").width()
                }, "slow", function() {
                    $(this).removeAttr("style");
                    $("#firstSlide div[data-scro='controler'] b").removeClass("down").eq(num).addClass("down")
                });
                num++;
                if (num == _list.size()) {
                    num = 0
                }
                _list.eq(num).animate({
                    "left": "0px"
                }, "slow");
                _list2.eq(num).animate({
                    "left": "0px"
                }, "slow")
            }, 6000)
        }
    };
    //$("#firstSlide .controler b").slice(4, 10).hide();
    try {
        $("#firstSlide .controler a").click(function() {
            !$(this).hasClass("fold") ? $(this).addClass("fold") && $(this).find(".appname").html("收起") && $("#firstSlide .controler b").slice(4, 10).slideDown() : $(this).removeClass("fold") && $(this).find(".appname").html("更多") && $("#firstSlide .controler b").slice(4, 10).slideUp()
        })
    } catch (e) {}
    (function() {
        $("#secondSlide div[data-scro='controler'] b,#secondSlide div[data-scro='controler2'] a").click(function() {
            var T = $(this);
            if (T.attr("class") == "down") {
                return false
            }
            J2ROLLING_ANIMATION.st({
                findObject: T,
                main: T.parent().parent().find("div[data-scro='list']"),
                main2: T.parent().parent().find("div[data-scro='list2']"),
                pagSource: T.parent().parent().find("div[data-scro='controler'] b"),
                className: "down",
                duration: "fast",
                on: $(this)[0].tagName == "A" ? true : false
            });
            return false
        });
        var J2SETTIME = ""
          , J2Time = true
          , J2ROLLING_ANIMATION = {
            init: function() {
                this.start();
                this.time()
            },
            st: function(o) {
                if (J2Time) {
                    this.animate(o.findObject, o.main, o.main2, o.className, o.duration, o.pagSource, o.on);
                    J2Time = false
                }
            },
            animate: function(T, M, M2, C, S, P, O) {
                var _prevDown = O ? P.parent().find("*[class='" + C + "']") : T.parent().find(T[0].tagName + "[class='" + C + "']")
                  , _prevIndex = _prevDown.index()
                  , _thisIndex = O ? (T.attr("class") == "next" ? _prevIndex + 1 : _prevIndex - 1) : T.index()
                  , _list = M.find(".item")
                  , _list2 = M2.find(".item")
                  , p2n = 1;
                _prevDown.removeClass(C);
                if (O) {
                    if (_thisIndex == -1) {
                        _thisIndex = _list.size() - 1
                    }
                    if (_thisIndex == _list.size()) {
                        _thisIndex = 0
                    }
                    P.eq(_thisIndex).addClass(C)
                } else {
                    T.addClass(C)
                }
                if (T.attr("class") == "prev" || _thisIndex < _prevIndex) {
                    p2n = false
                }
                if ((T.attr("class") == "next" || _thisIndex > _prevIndex) && T.attr("class") != "prev") {
                    p2n = true
                }
                !p2n ? _list.eq(_thisIndex).css("left", -M.width()) : "";
                !p2n ? _list2.eq(_thisIndex).css("left", -M.width()) : "";
                _list.eq(_prevIndex).animate({
                    left: p2n ? -M.width() : M.width()
                }, S, function() {
                    $(this).removeAttr("style");
                    J2Time = true
                });
                _list2.eq(_prevIndex).animate({
                    left: p2n ? -M.width() : M.width()
                }, S, function() {
                    $(this).removeAttr("style");
                    J2Time = true
                });
                _list.eq(_thisIndex).animate({
                    left: "0px"
                }, S);
                _list2.eq(_thisIndex).animate({
                    left: "0px"
                }, S)
            },
            start: function() {
                $("#secondSlide div[data-scro='controler'] b,#secondSlide div[data-scro='controler2'] a").mouseover(function() {
                    window.clearInterval(J2SETTIME)
                }).mouseout(function() {
                    J2ROLLING_ANIMATION.time()
                })
            },
            time: function() {
                J2SETTIME = window.setInterval(function() {
                    var num = $("#secondSlide div[data-scro='controler'] b[class='down']").index()
                      , _list = $("#secondSlide div[data-scro='list'] li")
                      , _list2 = $("#secondSlide div[data-scro='list2'] li");
                    _list.eq(num).animate({
                        "left": -$("#secondSlide div[data-scro='list']").width()
                    }, "slow", function() {
                        $(this).removeAttr("style");
                        $("#secondSlide div[data-scro='controler'] b").removeClass("down").eq(num).addClass("down")
                    });
                    _list2.eq(num).animate({
                        "left": -$("#secondSlide div[data-scro='list2']").width()
                    }, "slow", function() {
                        $(this).removeAttr("style");
                        $("#secondSlide div[data-scro='controler'] b").removeClass("down").eq(num).addClass("down")
                    });
                    num++;
                    if (num == _list.size()) {
                        num = 0
                    }
                    _list.eq(num).animate({
                        "left": "0px"
                    }, "slow");
                    _list2.eq(num).animate({
                        "left": "0px"
                    }, "slow")
                }, 6000)
            }
        }
    })();
    $("ul.nav-list li:eq(2)").hover(function() {
        $(".subnav").removeClass("hide");
        $("ul.nav-list .addvalue").addClass("hover")
    });
    $("ul.nav-list li:eq(2)").mouseleave(function() {
        $(".subnav").addClass("hide");
        $("ul.nav-list .addvalue").removeClass("hover")
    });
    function caseAutoWidth() {
        var caseWidth = $(window).width() >= "1000" ? $(window).width() / 5 : "200px";
        var caseImgWidth = $(".casewrap .caseitem img").width();
        var caseImgHeight = $(".casewrap .caseitem img").height();
        $(".casewrap .caseitem").width(caseWidth);
        $(".casewrap .caseitem").height(caseWidth * (caseImgHeight / caseImgWidth))
    }
    caseAutoWidth();
    if (window.devicePixelRatio > 1) {
        var lowresImages = $(".pagespc .item img,.pagesmobi .item img,.appimg img,.attendbigimg img,.xyimg img,.xybigimg img");
        lowresImages.each(function(i) {
            var lowres = $(this).attr("src");
            var highres = lowres.replace(".", "@2x.");
            $(this).attr("src", highres)
        })
    }
    function animationLCR() {
        $(".animationLCR").each(function() {
            var rowOffsetTop = $(this).offset().top;
            if ($(document).scrollTop() > rowOffsetTop - $(window).height() + 160) {
                $(this).find("li").eq(0).addClass("slideleft");
                $(this).find("li").eq(1).addClass("zoomin");
                $(this).find("li").eq(2).addClass("slideright");
                $(this).find("li").eq(3).addClass("slideleft");
                $(this).find("li").eq(4).addClass("zoomin");
                $(this).find("li").eq(5).addClass("slideright");
                $(this).addClass("show")
            }
        })
    }
    animationLCR();
    function animationZoomIn() {
        $(".animationZoomIn").each(function() {
            var rowOffsetTop = $(this).offset().top;
            if ($(document).scrollTop() > rowOffsetTop - $(window).height() + 160) {
                $(this).find("a").addClass("zoomin");
                $(this).addClass("show")
            }
        })
    }
    animationZoomIn();
    $(window).resize(function() {
        $("#screenHover").height($(window).height());
        bannerAuto();
        if ($(window).width() >= 769) {
            $("ul.nav").show();
            $("ul.nav").css({
                "box-shadow": "none"
            });
            $(".subnav").removeClass("static");
            $(".subnav").addClass("hide")
        } else {
            $("ul.nav").hide();
            $(".subnav").addClass("static");
            $(".subnav").removeClass("hide")
        }
        indexVideoPlay();
        caseAutoWidth()
    });
    $(window).scroll(function() {
        indexTopFixed();
        bannerAuto();
        if ($(window).scrollTop() >= 300) {
            $(".right-fixed").fadeIn(300)
        } else {
            $(".right-fixed").fadeOut(300)
        }
        caseAutoWidth();
        animationLCR();
        animationZoomIn()
    })
});
function openWin(title, url, width, height) {
    var cont = "width=" + width + ",height=" + height + ",top=" + (screen.height - height) / 2 + ",left=" + (screen.width - width) / 2 + ",toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no,status=no";
    var childWin = window.open(url, "_blank", cont);
    if (childWin.document) {
        childWin.document.title = title
    }
}
var showYouku = function(id, vid) {
    $("#" + id).empty();
    player = new YKU.Player(id,{
        styleid: "0",
        client_id: "d41e9cb1541b2b1c",
        vid: vid,
        autoplay: false,
        show_related: false
    })
}
;
var showIndexVideo = function(id, vid) {
    $(".index-bg").show();
    $("#" + id).empty().show();
    player = new YKU.Player(id,{
        styleid: "0",
        client_id: "d41e9cb1541b2b1c",
        vid: vid,
        autoplay: true,
        show_related: false
    })
}
;
var videoClose = function() {
    $(".index-bg").hide();
    $("#indexVideo").empty().hide()
}
;
var listenClick = function(btnStr) {
    var d = new Date();
    var dYear = d.getFullYear().toString();
    var dMonth = (d.getMonth() + 1).toString();
    var dDay = d.getDate().toString();
    var dHours = d.getHours().toString();
    var dMinutes = d.getMinutes().toString();
    var dSeconds = d.getSeconds().toString();
    var dMilliseconds = d.getMilliseconds().toString();
    var dZone = d.toString().substr(-5, d.lenght);
    function checkTime(i) {
        if (i < 10) {
            i = "0" + i
        }
        return i
    }
    dMonth = checkTime(dMonth).toString();
    dDay = checkTime(dDay).toString();
    dHours = checkTime(dHours).toString();
    dMinutes = checkTime(dMinutes).toString();
    dSeconds = checkTime(dSeconds).toString();
    dFullTime = dYear + dMonth + dDay + dHours + dMinutes + dSeconds + dMilliseconds;
    var msgJson = '{"time":"' + dFullTime + '","cid":"","uid":"","productTag":"portal_home","actionTag":"' + btnStr + '","puse":"web_js","ip":"","targetTag":""}';
    $.ajax({
        url: "https://jincai.jingoal.com/agent/log/logsend?topic=web.action&msg=" + msgJson
    })
}
;
$(function() {
    var scrtime;
    $(".indexad_wrap").hover(function() {
        clearInterval(scrtime)
    }, function() {
        scrtime = setInterval(function() {
            var $ul = $(".indexad_wrap ul");
            $ul.animate({
                marginTop: "-50px"
            }, 1000, function() {
                $ul.find("li:last").prependTo($ul);
                $ul.find("li:first").hide();
                $ul.css({
                    marginTop: 0
                });
                $ul.find("li:first").show()
            })
        }, 4000)
    }).trigger("mouseleave")
});
